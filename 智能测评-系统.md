### **软考高级系统架构设计师——综合知识智能自我测评系统**
### **需求规格说明书**

**版本：V3.1**
**日期：2025年12月9日**

---

### **1. 引言**

#### **1.1 项目背景**
系统架构设计师考试作为国家计算机技术与软件专业技术资格（水平）考试（简称“软考”）的高级项目，其“综合知识”科目因题量大（75道选择题）、知识点覆盖面广，成为考生备考过程中的一大挑战。当前考生普遍面临的问题是：缺乏有效的自我水平评估工具、难以定位知识盲区，以及缺少科学、个性化的复习策略指导。本项目旨在利用先进的大语言模型（Gemini Pro系列）的深度语义理解和智能分析能力，结合官方考试大纲、精选知识点练习题、近5年历年真题以及**一份预先分析好的知识点权重表**，构建一个集“动态智能组卷-在线模拟测评-深度能力诊断-个性化路径建议-社交化分享”于一体的闭环式自我测评系统。

#### **1.2 项目目标**
*   **千人千卷**：基于**预设的知识点权重**和智能抽样算法，为每位用户的每次测评动态生成独一无二的模拟试卷，避免因重复刷题导致的“伪高分”现象，确保测评结果的真实性。
*   **会话保持**：通过缓存机制，确保用户在短时间内（30分钟）刷新页面或因网络问题中断后，能够无缝恢复答题进度，保障测评体验的连续性和完整性。
*   **深度洞察**：利用大模型对用户的答题数据进行深度挖掘，精准勾勒用户知识图谱，识别优势与薄弱环节，并提供基于“投入产出比”的成绩提升预测，让备考更具策略性。
*   **便捷管理**：为系统管理员提供一个直观的后台管理界面，简化Markdown格式的考纲、题库资料以及**知识点权重表**的录入与维护流程，并支持对大模型API参数进行灵活配置。

#### **1.3 目标用户**
所有准备参加或正在备考“软考高级系统架构设计师”资格考试的考生。

#### **1.4 名词术语**
*   **综合知识**：系统架构设计师考试的客观题科目，形式为75道单项选择题，满分75分，45分及格。
*   **知识点权重**：**一份根据历年真题频率和重要性预先分析和定义的表格数据**，为每个知识点赋予等级（如：核心/重要/一般/冷门）和数字化权重。
*   **智能组卷**：系统综合考纲、知识点权重、题源配比等多种因素，动态生成一套模拟试卷的过程。
*   **会话保持**：在30分钟的窗口期内，为同一用户（通过浏览器指纹或Cookie识别）保留其未完成的试卷和答题状态。

---

### **2. 系统总体设计**

#### **2.1 业务流程**
1.  **数据初始化（后台）**：管理员通过后台上传Markdown格式的考纲、知识点练习题、近5年真题，以及**一份预先分析好的知识点权重表（如Excel/CSV格式）**。系统将所有数据解析入库，并将权重数据与知识点进行关联。
2.  **用户请求与组卷（前后台交互）**：
    *   用户首次访问系统，前端生成唯一的`SessionID`（如使用FingerprintJS或UUID）并发送给后端。
    *   后端根据`SessionID`检查Redis缓存中是否存在30分钟内有效的测评会话。
    *   **存在会话**：直接从Redis返回已缓存的试卷数据及用户已作答的答案，前端恢复答题场景。
    *   **不存在会话**：触发智能组卷模块，根据权重策略动态生成一套全新的75道题试卷，将试卷数据存入Redis（设置30分钟过期），并将试卷返回给前端。
3.  **在线答题（前端）**：用户在无登录状态下进行答题。答题过程中，前端定期（如每30秒或每答一题）将用户的答案异步同步至后端，后端更新Redis中的会话数据，防止意外退出导致数据丢失。
4.  **提交与分析（前后台交互）**：用户主动提交试卷或倒计时结束自动提交。后端进行自动判分，随后将用户的得分、错题分布、关联知识点等结构化数据打包，调用大模型进行深度分析。
5.  **报告反馈（前端）**：后端接收到大模型生成的分析报告（JSON格式），整合后返回给前端。前端以图文并茂的形式展示完整的测评报告。
6.  **社交分享（前端）**：用户在报告页点击分享，前端请求大模型生成适合社交媒体的文案和图片元素，用户可自行复制或保存。

#### **2.2 技术架构**
*   **前端**：采用 **React** 框架构建单页面应用（SPA），实现丰富的交互和响应式布局，适配PC和移动端设备。
*   **后端**：采用 **Python** (推荐使用 **FastAPI** 框架)，以充分利用其成熟的AI生态库和异步处理能力。
*   **AI核心**：**Google Gemini Pro** 系列大语言模型（通过API调用）。
*   **数据存储**：
    *   **持久化层 (数据库)**：**MySQL**。用于存储结构化的考纲、知识点、题库、历年真题、知识点权重以及用户已完成的测评历史记录。
    *   **缓存层 (内存数据库)**：**Redis**。作为系统的核心组件，用于实现“会话保持”功能。存储键值对，例如：`Key: "exam_session:{session_id}"`，`Value: { "paper_id": "...", "questions": [...], "user_answers": {...}, "start_time": "..." }`。

---

### **3. 功能需求详解**

#### **3.1 后台管理模块**
*   **3.1.1 数据录入与管理界面**
    *   **考纲上传/管理**：支持上传Markdown文件。系统需能解析`#`、`##`、`-`等标记，自动构建章节与知识点的树状结构并入库。
    *   **题库上传/管理**：
        *   **知识点练习题**：支持批量上传Markdown文件。系统能解析特定格式（如`#### 题目`, `**答案**`, `**解析**`）并自动入库。
        *   **历年真题**：支持批量上传Markdown文件。上传后，系统可调用大模型辅助进行题目与考纲知识点的自动关联，并允许管理员进行人工校对。
    *   **知识点权重管理**：支持上传（如CSV/Excel文件）或手动录入知识点权重表。系统需能解析表格内容（如：章节、知识点、权重等级、数字化权重等），并与数据库中的知识点进行精确匹配和关联。
    *   **数据预览与编辑**：提供统一界面让管理员可以查看、搜索、修改和删除已入库的所有数据。
*   **3.1.2 AI配置模块**
    *   **大模型API配置**：提供表单用于配置和更新Gemini Pro的API Key、Endpoint等连接参数。
    *   **Prompt模板管理**：允许管理员查看和微调用于各项AI任务（如报告生成、分享文案生成）的Prompt模板。

#### **3.2 智能组卷模块 (核心功能)**
*   **3.2.1 组卷策略**
    *   **题源配比**：每次组卷严格遵循以下比例：**历年真题(约30%) + 知识点练习题(约50%) + 大模型基于现有题目进行的变式生成题(约20%)**。
    *   **权重导向**：根据**已录入的知识点权重表**进行分层抽样，确保高权重知识点的题目占比较高，模拟真实考试的重点分布。
    *   **随机性与唯一性**：结合随机抽样算法，确保每次生成的试卷题目组合都不同，实现“千人千卷”。
*   **3.2.2 会话保持机制 (基于Redis)**
    *   **用户标识**：前端通过`FingerprintJS`库生成稳定的浏览器指纹，或由后端生成UUID存入客户端Cookie，作为`SessionID`。
    *   **缓存逻辑**：
        1.  用户请求开始测评时，后端首先使用`SessionID`查询Redis。
        2.  若命中缓存且未过期，直接返回缓存中的试卷数据。
        3.  若未命中或已过期，则执行**3.2.1**的组卷策略生成新试卷，并将试卷数据存入Redis，设置TTL（Time-To-Live）为30分钟。

#### **3.3 在线测评模块 (前端)**
*   **3.3.1 界面与交互**
    *   **响应式布局**：界面自动适应PC和手机屏幕。
    *   **答题卡**：提供题目导航面板，清晰显示已答、未答、标记题目，支持快速跳转。
    *   **倒计时器**：考试总时长为150分钟，时间耗尽将自动提交试卷。
*   **3.3.2 状态同步与恢复**
    *   **状态恢复**：页面加载时，若从后端获取到的是一个进行中的会话，前端需自动填充用户已选答案，并根据`start_time`计算并恢复倒计时。
    *   **答案自动同步**：用户每完成一道题或每隔30秒，前端自动将当前所有题目的作答情况静默发送至后端，更新Redis缓存，最大限度减少数据丢失风险。

#### **3.4 自动判分与测评报告模块**
*   **3.4.1 即时反馈**
    *   **基础数据**：提交后立即展示总得分、正确率、答题用时。
    *   **试题回顾**：以列表形式展示全部75道题，清晰标出用户的选择、正确答案，并提供官方解析。错误题目会高亮显示。
*   **3.4.2 AI智能分析报告 (由大模型生成)**
    *   **知识点掌握画像**：
        *   **优势项**：您在`[章节A]`、`[知识点B]`上表现出色，掌握牢固。
        *   **薄弱项**：`[章节C]`、`[知识点D]`是您的主要失分点，需重点关注。
        *   **可视化图表**：使用雷达图或柱状图直观展示用户在考纲各大章节上的得分率。
    *   **当前水平评价**：结合得分和知识点掌握情况，给出形象化的定性评级（如：**架构师学徒**、**初级架构师**、**准高级架构师**）并对标历年真题难度，给出当前水平的综合评价。
    *   **真实考试预测**：
        *   **预测模型**：基于当前得分与45分及格线的差距，以及薄弱项的权重。
        *   **输出格式**：“您本次测评得分 **[X]** 分。若能在未来 **[Y周]** 内，集中精力攻克 **[薄弱知识点A]** 和 **[薄弱知识点B]** 等核心失分项，预计您的真实考试分数有望达到 **[Z-Z+5]** 分的水平。”
    *   **个性化学习路径建议**：
        *   **定义**：提供一个基于优先级和依赖关系的学习顺序建议，而非具体的每日计划。
        *   **生成逻辑**：
            1.  **第一优先级**：攻克“高权重 & 低正确率”的知识点（提分最快）。
            2.  **第二优先级**：弥补“中权重 & 低正确率”的知识点（稳固基础）。
            3.  **第三优先级**：回顾“高权重 & 高正确率”的知识点（巩固优势）。
            4.  **第四优先级**：对于“低权重”的知识点，建议考前快速浏览或战略性放弃。
        *   **输出形式**：一个有序列表，如：“1. 立即开始学习《计算机网络》中的TCP/IP协议栈... 2. 接着，请系统复习《数据库系统》中的SQL优化...”。

#### **3.5 社交分享模块**
*   **内容生成**：提供“生成分享卡片”按钮。后端调用大模型，根据用户的测评结果（分数、评级、亮点）生成不同风格（如凡尔赛炫耀风、自嘲励志风、学霸笔记风）的文案和一张包含核心数据的精美分享图。
*   **分享功能**：提供“复制文案”和“保存图片”的功能，方便用户分享到小红书、朋友圈、视频号等社交平台。

---

### **4. 非功能需求**

#### **4.1 性能需求**
*   **页面加载**：核心页面（首页、答题页、报告页）在普通网络环境下首次加载时间应小于3秒。
*   **API响应时间**：
    *   常规API（如题目获取、答案同步）响应时间应在500ms以内。
    *   智能组卷接口响应时间应在2秒以内。
    *   提交试卷并生成AI报告的整体耗时应控制在15秒以内，期间前端需提供明确的加载提示。
*   **并发支持**：系统应能支持至少100 QPS的并发请求，Redis和数据库的连接池配置需优化以应对突发流量。

#### **4.2 可用性与可靠性**
*   **可用性**：系统应保证99.9%的可用性。
*   **数据一致性**：在30分钟的会话窗口期内，必须保证用户访问到的试卷和答题状态是完全一致的。
*   **容错性**：大模型API调用失败时，应有优雅降级策略（如返回基础的判分报告，并提示AI分析失败）和重试机制。

#### **4.3 安全性需求**
*   **防刷机制**：对关键API接口（如开始测评、提交试卷）设置合理的速率限制（Rate Limiting），防止恶意请求和API滥用。
*   **后台安全**：后台管理系统需有严格的身份验证机制（如账号密码登录），防止未经授权的访问。
*   **数据安全**：所有与外部API的通信（尤其是大模型API）必须使用HTTPS加密传输。

---

### **5. 交付物清单**

1.  **文档**：
    *   本需求规格说明书 (SRS) V3.1
    *   系统架构设计文档 (含技术选型、部署架构图)
    *   数据库设计文档 (E-R图及表结构 for MySQL)
    *   API接口文档 (Swagger/OpenAPI格式)
    *   核心AI任务的Prompt设计集合
2.  **软件**：
    *   前端应用程序源代码 (React) 及构建产物
    *   后端应用程序源代码 (Python/FastAPI)
    *   部署脚本 (Dockerfile, docker-compose.yml)
3.  **测试**：
    *   单元测试报告
    *   系统测试用例及报告

后端管理系统增加仪表盘功能，提供数据统计、分析、可视化能力！
含：用户及答题情况、本地资料信息、AI调用情况。
- 用户信息：
1）用户列表信息（动态显示、最近排最前）：
用户指纹信息、IP地址、地理位置、用户设备（PC、安卓、iOS）、开始答题时间、提交时间、得分、评级（架构学徒、初级架构师、准高级架构师）。
2）用户统计信息：
用户总数量（按用户指纹信息去重）、当日在线数量（按用户指纹信息去重）、在线趋势、用户增长趋势、地理位置分布（柱状图）、用户设备占比、开始答题时间分布、耗时情况分布（提交-开始时间）、得分分布、易错题统计。
- 本地资料信息：
1）静态信息：
题目总数、历年真题数、知识点练习题数、AI生成题目数、大章节数、知识点数
2）统计信息：
题目总数变化趋势、历年真题变化趋势、知识点练习题变化趋势、AI生成题目变化趋势
知识点权重排名、智能组卷知识点分布
- AI调用情况：
成功调用次数、失败调用次数、智能组卷AI调用次数、AI报告调用次数、社交分析AI调用次数、响应时长，以及相应的变化趋势。